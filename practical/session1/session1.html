<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Training in ade4 in R - Module I: Basic methods</title>
    <meta charset="utf-8" />
    <meta name="author" content="Stéphane Dray" />
    <meta name="date" content="2021-04-18" />
    <script src="libs/htmlwidgets/htmlwidgets.js"></script>
    <script src="libs/rglWebGL-binding/rglWebGL.js"></script>
    <link href="libs/rglwidgetClass/rgl.css" rel="stylesheet" />
    <script src="libs/rglwidgetClass/rglClass.src.js"></script>
    <script src="libs/rglwidgetClass/utils.src.js"></script>
    <script src="libs/rglwidgetClass/subscenes.src.js"></script>
    <script src="libs/rglwidgetClass/shaders.src.js"></script>
    <script src="libs/rglwidgetClass/textures.src.js"></script>
    <script src="libs/rglwidgetClass/projection.src.js"></script>
    <script src="libs/rglwidgetClass/mouse.src.js"></script>
    <script src="libs/rglwidgetClass/init.src.js"></script>
    <script src="libs/rglwidgetClass/pieces.src.js"></script>
    <script src="libs/rglwidgetClass/draw.src.js"></script>
    <script src="libs/rglwidgetClass/controls.src.js"></script>
    <script src="libs/rglwidgetClass/selection.src.js"></script>
    <script src="libs/rglwidgetClass/rglTimer.src.js"></script>
    <script src="libs/CanvasMatrix4/CanvasMatrix.src.js"></script>
    <link rel="stylesheet" href="custom.css" type="text/css" />
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Training in ade4 in R - Module I: Basic methods
## Practical 1: understanding multivariate methods in 3D
### Stéphane Dray
### 2021-04-18

---

$$
%center text/code
\newcommand{\bcenter}{\begin{center}}
\newcommand{\ecenter}{\end{center}}
$$

$$
\newcommand{\bm}[1]{\boldsymbol{\mathbf{#1}}}
\newcommand{\tr}{\hspace{-0.05cm}^{\top}\hspace{-0.05cm}}% transpose d'une matrice
\newcommand{\mb}[1]{\mathbf{#1}}
\newcommand{\pt}{\mathsmaller \bullet}% petit point pour les indices
$$


$$
\newcommand{\triplet}[3]{
% pour ecrire un triplet dans le texte
$\left ( #1, #2, #3 \right )$
}
$$

$$
\newcommand{\sqnorm}[2]{
%norme au carré
\lVert  #1 \rVert^2_{#2}
}
$$

$$
\newcommand{\norm}[2]{
%norme
 \lVert #1 \rVert_{#2}
}
$$






---
# Introduction

In this practical we will try to understand the main principles of multivariate methods by interactive representation in 3 dimensions using the `rgl` package

First, load the required packages:


```r
library(ade4)
library(rgl)
```

and then the data set `doubs` available in `ade4`


```r
data(doubs)
```
---
# Data

The data set contains information on 30 sites sampled on the Doubs river:

- Measurments of 11 environmental variables in `$env`
- Abundances of 27 fish species in `$fish`
- Spatial coordinates of the sites in `$xy`

More details? Try `?doubs`

Select 3 environmental variables for this practical and define a vector to color the different sites:


```r
tab &lt;- doubs$env[, c(3, 8, 10)]
color &lt;- rainbow(30, alpha = 0.5)
```
---
# Representing data: space of individuals

Load some utilities functions available in the R directory and plot the original data:



```r
source("../../R/3D-utils.R")
plot3d(tab, type = "s", col = color)
```

.pull-left[
<div id="rgl58727" style="width:288px;height:288px;" class="rglWebGL html-widget"></div>
<script type="application/json" data-for="rgl58727">{"x":{"material":{"color":"#000000","alpha":1,"lit":true,"ambient":"#000000","specular":"#FFFFFF","emission":"#000000","shininess":50,"smooth":true,"front":"filled","back":"filled","size":3,"lwd":1,"fog":true,"point_antialias":false,"line_antialias":false,"texture":null,"textype":"rgb","texmipmap":false,"texminfilter":"linear","texmagfilter":"linear","texenvmap":false,"depth_mask":true,"depth_test":"less","isTransparent":false,"polygon_offset":[0,0]},"rootSubscene":732,"objects":{"738":{"id":738,"type":"spheres","material":{},"vertices":[[6.17600011825562,20,122],[3.43400001525879,20,103],[3.63800001144409,22,105],[3.49699997901917,21,110],[3.17799997329712,52,80],[3.49699997901917,15,102],[4.20499992370605,15,111],[3.25799989700317,41,70],[2.56500005722046,82,72],[4.60500001907349,75,100],[3.73799991607666,160,115],[2.83299994468689,50,122],[3.09100008010864,52,124],[2.56500005722046,123,123],[1.79200005531311,100,117],[3.04500007629395,200,103],[1.79200005531311,250,102],[2.19700002670288,220,103],[1.79200005531311,220,106],[2.19700002670288,300,103],[2.39800000190735,220,90],[2.70799994468689,162,91],[2.56500005722046,350,63],[1.3860000371933,250,52],[1.79200005531311,620,41],[1.79200005531311,300,62],[2.56500005722046,300,72],[1.3860000371933,400,81],[1.94599997997284,162,90],[1.09899997711182,160,82]],"colors":[[1,0,0,1],[1,0.200000002980232,0,1],[1,0.400000005960464,0,1],[1,0.600000023841858,0,1],[1,0.800000011920929,0,1],[1,1,0,1],[0.800000011920929,1,0,1],[0.600000023841858,1,0,1],[0.400000005960464,1,0,1],[0.200000002980232,1,0,1],[0,1,0,1],[0,1,0.200000002980232,1],[0,1,0.400000005960464,1],[0,1,0.600000023841858,1],[0,1,0.800000011920929,1],[0,1,1,1],[0,0.800000011920929,1,1],[0,0.600000023841858,1,1],[0,0.400000005960464,1,1],[0,0.200000002980232,1,1],[0,0,1,1],[0.200000002980232,0,1,1],[0.400000005960464,0,1,1],[0.600000023841858,0,1,1],[0.800000011920929,0,1,1],[1,0,1,1],[1,0,0.800000011920929,1],[1,0,0.600000023841858,1],[1,0,0.400000005960464,1],[1,0,0.200000002980232,1]],"radii":[[17.6290435791016]],"centers":[[6.17600011825562,20,122],[3.43400001525879,20,103],[3.63800001144409,22,105],[3.49699997901917,21,110],[3.17799997329712,52,80],[3.49699997901917,15,102],[4.20499992370605,15,111],[3.25799989700317,41,70],[2.56500005722046,82,72],[4.60500001907349,75,100],[3.73799991607666,160,115],[2.83299994468689,50,122],[3.09100008010864,52,124],[2.56500005722046,123,123],[1.79200005531311,100,117],[3.04500007629395,200,103],[1.79200005531311,250,102],[2.19700002670288,220,103],[1.79200005531311,220,106],[2.19700002670288,300,103],[2.39800000190735,220,90],[2.70799994468689,162,91],[2.56500005722046,350,63],[1.3860000371933,250,52],[1.79200005531311,620,41],[1.79200005531311,300,62],[2.56500005722046,300,72],[1.3860000371933,400,81],[1.94599997997284,162,90],[1.09899997711182,160,82]],"ignoreExtent":false,"fastTransparency":true,"flags":32771},"740":{"id":740,"type":"text","material":{"lit":false},"vertices":[[3.63750004768372,-128.052230834961,21.3745193481445]],"colors":[[0,0,0,1]],"texts":[["slo"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[3.63750004768372,-128.052230834961,21.3745193481445]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":33808},"741":{"id":741,"type":"text","material":{"lit":false},"vertices":[[-0.101606220006943,317.5,21.3745193481445]],"colors":[[0,0,0,1]],"texts":[["nit"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-0.101606220006943,317.5,21.3745193481445]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":33808},"742":{"id":742,"type":"text","material":{"lit":false},"vertices":[[-0.101606220006943,-128.052230834961,82.5]],"colors":[[0,0,0,1]],"texts":[["oxy"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-0.101606220006943,-128.052230834961,82.5]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":33808},"736":{"id":736,"type":"light","vertices":[[0,0,1]],"colors":[[1,1,1,1],[1,1,1,1],[1,1,1,1]],"viewpoint":true,"finite":false},"735":{"id":735,"type":"background","material":{},"colors":[[0.298039227724075,0.298039227724075,0.298039227724075,1]],"centers":[[0,0,0]],"sphere":false,"fogtype":"none","fogscale":1,"flags":32768},"737":{"id":737,"type":"background","material":{"lit":false,"back":"lines"},"colors":[[1,1,1,1]],"centers":[[0,0,0]],"sphere":false,"fogtype":"none","fogscale":1,"flags":32768},"739":{"id":739,"type":"bboxdeco","material":{"front":"lines","back":"lines"},"vertices":[[1,"NA","NA"],[2,"NA","NA"],[3,"NA","NA"],[4,"NA","NA"],[5,"NA","NA"],[6,"NA","NA"],["NA",0,"NA"],["NA",100,"NA"],["NA",200,"NA"],["NA",300,"NA"],["NA",400,"NA"],["NA",500,"NA"],["NA",600,"NA"],["NA","NA",40],["NA","NA",60],["NA","NA",80],["NA","NA",100],["NA","NA",120]],"colors":[[0,0,0,1]],"draw_front":true,"newIds":[750,751,752,753,754,755,756]},"732":{"id":732,"type":"subscene","par3d":{"antialias":8,"FOV":30,"ignoreExtent":false,"listeners":732,"mouseMode":{"left":"trackball","right":"zoom","middle":"fov","wheel":"pull"},"observer":[0,0,1643.56677246094],"modelMatrix":[[69.4161529541016,0,0,-252.501266479492],[0,0.199322000145912,3.99168705940247,-392.598907470703],[0,-0.547632694244385,1.45285534858704,-1589.55395507812],[0,0,0,1]],"projMatrix":[[3.73205089569092,0,0,0],[0,3.73205089569092,0,0],[0,0,-3.86370348930359,-5924.86865234375],[0,0,-1,0]],"skipRedraw":false,"userMatrix":[[1,0,0,0],[0,0.342020143325668,0.939692620785909,0],[0,-0.939692620785909,0.342020143325668,0],[0,0,0,1]],"userProjection":[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],"scale":[69.4161529541016,0.582778513431549,4.24786472320557],"viewport":{"x":0,"y":0,"width":1,"height":1},"zoom":1,"bbox":[0.845038294792175,6.42996168136597,-15.2499885559082,650.25,36.8499031066895,128.150100708008],"windowRect":[48,120,304,376],"family":"sans","font":1,"cex":1,"useFreeType":true,"fontname":"/home/stephane/Documents/R/librairies/rgl/fonts/FreeSans.ttf","maxClipPlanes":8,"glVersion":3,"activeSubscene":0},"embeddings":{"viewport":"replace","projection":"replace","model":"replace","mouse":"replace"},"objects":[737,739,738,740,741,742,736,750,751,752,753,754,755,756],"subscenes":[],"flags":34131},"750":{"id":750,"type":"lines","material":{"lit":false},"vertices":[[1,-25.2324886322021,35.4804000854492],[6,-25.2324886322021,35.4804000854492],[1,-25.2324886322021,35.4804000854492],[1,-42.3691139221191,33.1294212341309],[2,-25.2324886322021,35.4804000854492],[2,-42.3691139221191,33.1294212341309],[3,-25.2324886322021,35.4804000854492],[3,-42.3691139221191,33.1294212341309],[4,-25.2324886322021,35.4804000854492],[4,-42.3691139221191,33.1294212341309],[5,-25.2324886322021,35.4804000854492],[5,-42.3691139221191,33.1294212341309],[6,-25.2324886322021,35.4804000854492],[6,-42.3691139221191,33.1294212341309]],"colors":[[0,0,0,1]],"centers":[[3.5,-25.2324886322021,35.4804000854492],[1,-33.8008003234863,34.3049087524414],[2,-33.8008003234863,34.3049087524414],[3,-33.8008003234863,34.3049087524414],[4,-33.8008003234863,34.3049087524414],[5,-33.8008003234863,34.3049087524414],[6,-33.8008003234863,34.3049087524414]],"ignoreExtent":true,"origId":739,"flags":32832},"751":{"id":751,"type":"text","material":{"lit":false},"vertices":[[1,-76.6423645019531,28.4274597167969],[2,-76.6423645019531,28.4274597167969],[3,-76.6423645019531,28.4274597167969],[4,-76.6423645019531,28.4274597167969],[5,-76.6423645019531,28.4274597167969],[6,-76.6423645019531,28.4274597167969]],"colors":[[0,0,0,1]],"texts":[["1"],["2"],["3"],["4"],["5"],["6"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[1,-76.6423645019531,28.4274597167969],[2,-76.6423645019531,28.4274597167969],[3,-76.6423645019531,28.4274597167969],[4,-76.6423645019531,28.4274597167969],[5,-76.6423645019531,28.4274597167969],[6,-76.6423645019531,28.4274597167969]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"origId":739,"flags":33808},"752":{"id":752,"type":"lines","material":{"lit":false},"vertices":[[0.761264443397522,0,35.4804000854492],[0.761264443397522,600,35.4804000854492],[0.761264443397522,0,35.4804000854492],[0.617452681064606,0,33.1294212341309],[0.761264443397522,100,35.4804000854492],[0.617452681064606,100,33.1294212341309],[0.761264443397522,200,35.4804000854492],[0.617452681064606,200,33.1294212341309],[0.761264443397522,300,35.4804000854492],[0.617452681064606,300,33.1294212341309],[0.761264443397522,400,35.4804000854492],[0.617452681064606,400,33.1294212341309],[0.761264443397522,500,35.4804000854492],[0.617452681064606,500,33.1294212341309],[0.761264443397522,600,35.4804000854492],[0.617452681064606,600,33.1294212341309]],"colors":[[0,0,0,1]],"centers":[[0.761264443397522,300,35.4804000854492],[0.689358592033386,0,34.3049087524414],[0.689358592033386,100,34.3049087524414],[0.689358592033386,200,34.3049087524414],[0.689358592033386,300,34.3049087524414],[0.689358592033386,400,34.3049087524414],[0.689358592033386,500,34.3049087524414],[0.689358592033386,600,34.3049087524414]],"ignoreExtent":true,"origId":739,"flags":32832},"753":{"id":753,"type":"text","material":{"lit":false},"vertices":[[0.329829126596451,0,28.4274597167969],[0.329829126596451,100,28.4274597167969],[0.329829126596451,200,28.4274597167969],[0.329829126596451,300,28.4274597167969],[0.329829126596451,400,28.4274597167969],[0.329829126596451,500,28.4274597167969],[0.329829126596451,600,28.4274597167969]],"colors":[[0,0,0,1]],"texts":[["0"],["100"],["200"],["300"],["400"],["500"],["600"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[0.329829126596451,0,28.4274597167969],[0.329829126596451,100,28.4274597167969],[0.329829126596451,200,28.4274597167969],[0.329829126596451,300,28.4274597167969],[0.329829126596451,400,28.4274597167969],[0.329829126596451,500,28.4274597167969],[0.329829126596451,600,28.4274597167969]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"origId":739,"flags":33808},"754":{"id":754,"type":"lines","material":{"lit":false},"vertices":[[0.761264443397522,-25.2324886322021,40],[0.761264443397522,-25.2324886322021,120],[0.761264443397522,-25.2324886322021,40],[0.617452681064606,-42.3691139221191,40],[0.761264443397522,-25.2324886322021,60],[0.617452681064606,-42.3691139221191,60],[0.761264443397522,-25.2324886322021,80],[0.617452681064606,-42.3691139221191,80],[0.761264443397522,-25.2324886322021,100],[0.617452681064606,-42.3691139221191,100],[0.761264443397522,-25.2324886322021,120],[0.617452681064606,-42.3691139221191,120]],"colors":[[0,0,0,1]],"centers":[[0.761264443397522,-25.2324886322021,80],[0.689358592033386,-33.8008003234863,40],[0.689358592033386,-33.8008003234863,60],[0.689358592033386,-33.8008003234863,80],[0.689358592033386,-33.8008003234863,100],[0.689358592033386,-33.8008003234863,120]],"ignoreExtent":true,"origId":739,"flags":32832},"755":{"id":755,"type":"text","material":{"lit":false},"vertices":[[0.329829126596451,-76.6423645019531,40],[0.329829126596451,-76.6423645019531,60],[0.329829126596451,-76.6423645019531,80],[0.329829126596451,-76.6423645019531,100],[0.329829126596451,-76.6423645019531,120]],"colors":[[0,0,0,1]],"texts":[["40"],["60"],["80"],["100"],["120"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[0.329829126596451,-76.6423645019531,40],[0.329829126596451,-76.6423645019531,60],[0.329829126596451,-76.6423645019531,80],[0.329829126596451,-76.6423645019531,100],[0.329829126596451,-76.6423645019531,120]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"origId":739,"flags":33808},"756":{"id":756,"type":"lines","material":{"lit":false},"vertices":[[0.761264443397522,-25.2324886322021,35.4804000854492],[0.761264443397522,660.232482910156,35.4804000854492],[0.761264443397522,-25.2324886322021,129.519607543945],[0.761264443397522,660.232482910156,129.519607543945],[0.761264443397522,-25.2324886322021,35.4804000854492],[0.761264443397522,-25.2324886322021,129.519607543945],[0.761264443397522,660.232482910156,35.4804000854492],[0.761264443397522,660.232482910156,129.519607543945],[0.761264443397522,-25.2324886322021,35.4804000854492],[6.51373529434204,-25.2324886322021,35.4804000854492],[0.761264443397522,-25.2324886322021,129.519607543945],[6.51373529434204,-25.2324886322021,129.519607543945],[0.761264443397522,660.232482910156,35.4804000854492],[6.51373529434204,660.232482910156,35.4804000854492],[0.761264443397522,660.232482910156,129.519607543945],[6.51373529434204,660.232482910156,129.519607543945],[6.51373529434204,-25.2324886322021,35.4804000854492],[6.51373529434204,660.232482910156,35.4804000854492],[6.51373529434204,-25.2324886322021,129.519607543945],[6.51373529434204,660.232482910156,129.519607543945],[6.51373529434204,-25.2324886322021,35.4804000854492],[6.51373529434204,-25.2324886322021,129.519607543945],[6.51373529434204,660.232482910156,35.4804000854492],[6.51373529434204,660.232482910156,129.519607543945]],"colors":[[0,0,0,1]],"centers":[[0.761264443397522,317.5,35.4804000854492],[0.761264443397522,317.5,129.519607543945],[0.761264443397522,-25.2324886322021,82.5],[0.761264443397522,660.232482910156,82.5],[3.63749980926514,-25.2324886322021,35.4804000854492],[3.63749980926514,-25.2324886322021,129.519607543945],[3.63749980926514,660.232482910156,35.4804000854492],[3.63749980926514,660.232482910156,129.519607543945],[6.51373529434204,317.5,35.4804000854492],[6.51373529434204,317.5,129.519607543945],[6.51373529434204,-25.2324886322021,82.5],[6.51373529434204,660.232482910156,82.5]],"ignoreExtent":true,"origId":739,"flags":32832}},"crosstalk":{"key":[],"group":[],"id":[],"options":[]},"width":288,"height":288,"sphereVerts":{"vb":[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0746578340503426,0.146446609406726,0.212607523691814,0.270598050073099,0.318189645143208,0.353553390593274,0.375330277517865,0.38268343236509,0.375330277517865,0.353553390593274,0.318189645143208,0.270598050073099,0.212607523691814,0.146446609406726,0.0746578340503426,0.137949689641472,0.270598050073099,0.392847479193551,0.5,0.587937801209679,0.653281482438188,0.693519922661074,0.707106781186547,0.693519922661074,0.653281482438188,0.587937801209679,0.5,0.392847479193551,0.270598050073099,0.137949689641472,0.180239955501737,0.353553390593274,0.513279967159337,0.653281482438188,0.768177756711416,0.853553390593274,0.906127446352888,0.923879532511287,0.906127446352888,0.853553390593274,0.768177756711416,0.653281482438188,0.513279967159337,0.353553390593274,0.180239955501737,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186548,0.831469612302545,0.923879532511287,0.98078528040323,1,0.98078528040323,0.923879532511287,0.831469612302545,0.707106781186548,0.555570233019602,0.38268343236509,0.195090322016128,0.180239955501737,0.353553390593274,0.513279967159337,0.653281482438188,0.768177756711416,0.853553390593274,0.906127446352888,0.923879532511287,0.906127446352888,0.853553390593274,0.768177756711416,0.653281482438188,0.513279967159337,0.353553390593274,0.180239955501737,0.137949689641472,0.270598050073099,0.392847479193551,0.5,0.587937801209679,0.653281482438188,0.693519922661074,0.707106781186548,0.693519922661074,0.653281482438188,0.587937801209679,0.5,0.392847479193551,0.270598050073099,0.137949689641472,0.0746578340503427,0.146446609406726,0.212607523691814,0.270598050073099,0.318189645143209,0.353553390593274,0.375330277517865,0.38268343236509,0.375330277517865,0.353553390593274,0.318189645143209,0.270598050073099,0.212607523691814,0.146446609406726,0.0746578340503427,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-0.0746578340503427,-0.146446609406726,-0.212607523691814,-0.270598050073099,-0.318189645143209,-0.353553390593274,-0.375330277517865,-0.38268343236509,-0.375330277517865,-0.353553390593274,-0.318189645143209,-0.270598050073099,-0.212607523691814,-0.146446609406726,-0.0746578340503427,-0.137949689641472,-0.270598050073099,-0.392847479193551,-0.5,-0.587937801209679,-0.653281482438188,-0.693519922661074,-0.707106781186548,-0.693519922661074,-0.653281482438188,-0.587937801209679,-0.5,-0.392847479193551,-0.270598050073099,-0.137949689641472,-0.180239955501737,-0.353553390593274,-0.513279967159337,-0.653281482438188,-0.768177756711416,-0.853553390593274,-0.906127446352888,-0.923879532511287,-0.906127446352888,-0.853553390593274,-0.768177756711416,-0.653281482438188,-0.513279967159337,-0.353553390593274,-0.180239955501737,-0.195090322016128,-0.38268343236509,-0.555570233019602,-0.707106781186548,-0.831469612302545,-0.923879532511287,-0.98078528040323,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186548,-0.555570233019602,-0.38268343236509,-0.195090322016128,-0.180239955501737,-0.353553390593274,-0.513279967159337,-0.653281482438188,-0.768177756711416,-0.853553390593274,-0.906127446352888,-0.923879532511287,-0.906127446352888,-0.853553390593274,-0.768177756711416,-0.653281482438188,-0.513279967159337,-0.353553390593274,-0.180239955501737,-0.137949689641472,-0.270598050073099,-0.392847479193551,-0.5,-0.587937801209679,-0.653281482438188,-0.693519922661074,-0.707106781186547,-0.693519922661074,-0.653281482438188,-0.587937801209679,-0.5,-0.392847479193551,-0.270598050073099,-0.137949689641472,-0.0746578340503426,-0.146446609406726,-0.212607523691814,-0.270598050073099,-0.318189645143208,-0.353553390593274,-0.375330277517865,-0.38268343236509,-0.375330277517865,-0.353553390593274,-0.318189645143208,-0.270598050073099,-0.212607523691814,-0.146446609406726,-0.0746578340503426,0,0],[-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,-1,1],[0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186548,0.831469612302545,0.923879532511287,0.98078528040323,1,0.98078528040323,0.923879532511287,0.831469612302545,0.707106781186548,0.555570233019602,0.38268343236509,0.195090322016128,0.180239955501737,0.353553390593274,0.513279967159337,0.653281482438188,0.768177756711416,0.853553390593274,0.906127446352888,0.923879532511287,0.906127446352888,0.853553390593274,0.768177756711416,0.653281482438188,0.513279967159337,0.353553390593274,0.180239955501737,0.137949689641472,0.270598050073099,0.392847479193551,0.5,0.587937801209679,0.653281482438188,0.693519922661074,0.707106781186548,0.693519922661074,0.653281482438188,0.587937801209679,0.5,0.392847479193551,0.270598050073099,0.137949689641472,0.0746578340503426,0.146446609406726,0.212607523691814,0.270598050073099,0.318189645143209,0.353553390593274,0.375330277517865,0.38268343236509,0.375330277517865,0.353553390593274,0.318189645143209,0.270598050073099,0.212607523691814,0.146446609406726,0.0746578340503426,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-0.0746578340503426,-0.146446609406726,-0.212607523691814,-0.270598050073099,-0.318189645143208,-0.353553390593274,-0.375330277517865,-0.38268343236509,-0.375330277517865,-0.353553390593274,-0.318189645143208,-0.270598050073099,-0.212607523691814,-0.146446609406726,-0.0746578340503426,-0.137949689641472,-0.270598050073099,-0.392847479193551,-0.5,-0.587937801209679,-0.653281482438188,-0.693519922661074,-0.707106781186547,-0.693519922661074,-0.653281482438188,-0.587937801209679,-0.5,-0.392847479193551,-0.270598050073099,-0.137949689641472,-0.180239955501737,-0.353553390593274,-0.513279967159337,-0.653281482438188,-0.768177756711416,-0.853553390593274,-0.906127446352888,-0.923879532511287,-0.906127446352888,-0.853553390593274,-0.768177756711416,-0.653281482438188,-0.513279967159337,-0.353553390593274,-0.180239955501737,-0.195090322016128,-0.38268343236509,-0.555570233019602,-0.707106781186548,-0.831469612302545,-0.923879532511287,-0.98078528040323,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186548,-0.555570233019602,-0.38268343236509,-0.195090322016128,-0.180239955501737,-0.353553390593274,-0.513279967159337,-0.653281482438188,-0.768177756711416,-0.853553390593274,-0.906127446352888,-0.923879532511287,-0.906127446352888,-0.853553390593274,-0.768177756711416,-0.653281482438188,-0.513279967159337,-0.353553390593274,-0.180239955501737,-0.137949689641472,-0.270598050073099,-0.392847479193551,-0.5,-0.58793780120968,-0.653281482438188,-0.693519922661074,-0.707106781186548,-0.693519922661074,-0.653281482438188,-0.58793780120968,-0.5,-0.392847479193551,-0.270598050073099,-0.137949689641472,-0.0746578340503427,-0.146446609406726,-0.212607523691814,-0.270598050073099,-0.318189645143209,-0.353553390593274,-0.375330277517866,-0.38268343236509,-0.375330277517866,-0.353553390593274,-0.318189645143209,-0.270598050073099,-0.212607523691814,-0.146446609406726,-0.0746578340503427,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0746578340503427,0.146446609406726,0.212607523691814,0.270598050073099,0.318189645143209,0.353553390593274,0.375330277517865,0.38268343236509,0.375330277517865,0.353553390593274,0.318189645143209,0.270598050073099,0.212607523691814,0.146446609406726,0.0746578340503427,0.137949689641472,0.270598050073098,0.392847479193551,0.5,0.587937801209679,0.653281482438188,0.693519922661074,0.707106781186547,0.693519922661074,0.653281482438188,0.587937801209679,0.5,0.392847479193551,0.270598050073098,0.137949689641472,0.180239955501737,0.353553390593274,0.513279967159337,0.653281482438188,0.768177756711416,0.853553390593274,0.906127446352888,0.923879532511287,0.906127446352888,0.853553390593274,0.768177756711416,0.653281482438188,0.513279967159337,0.353553390593274,0.180239955501737,0,0]],"it":[[0,1,2,3,4,5,6,7,8,9,10,11,12,13,15,16,17,18,19,20,21,22,23,24,25,26,27,28,30,31,32,33,34,35,36,37,38,39,40,41,42,43,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,61,62,63,64,65,66,67,68,69,70,71,72,73,75,76,77,78,79,80,81,82,83,84,85,86,87,88,90,91,92,93,94,95,96,97,98,99,100,101,102,103,105,106,107,108,109,110,111,112,113,114,115,116,117,118,120,121,122,123,124,125,126,127,128,129,130,131,132,133,135,136,137,138,139,140,141,142,143,144,145,146,147,148,150,151,152,153,154,155,156,157,158,159,160,161,162,163,165,166,167,168,169,170,171,172,173,174,175,176,177,178,180,181,182,183,184,185,186,187,188,189,190,191,192,193,195,196,197,198,199,200,201,202,203,204,205,206,207,208,210,211,212,213,214,215,216,217,218,219,220,221,222,223,225,226,227,228,229,230,231,232,233,234,235,236,237,238,0,1,2,3,4,5,6,7,8,9,10,11,12,13,15,16,17,18,19,20,21,22,23,24,25,26,27,28,30,31,32,33,34,35,36,37,38,39,40,41,42,43,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,61,62,63,64,65,66,67,68,69,70,71,72,73,75,76,77,78,79,80,81,82,83,84,85,86,87,88,90,91,92,93,94,95,96,97,98,99,100,101,102,103,105,106,107,108,109,110,111,112,113,114,115,116,117,118,120,121,122,123,124,125,126,127,128,129,130,131,132,133,135,136,137,138,139,140,141,142,143,144,145,146,147,148,150,151,152,153,154,155,156,157,158,159,160,161,162,163,165,166,167,168,169,170,171,172,173,174,175,176,177,178,180,181,182,183,184,185,186,187,188,189,190,191,192,193,195,196,197,198,199,200,201,202,203,204,205,206,207,208,210,211,212,213,214,215,216,217,218,219,220,221,222,223,225,226,227,228,229,230,231,232,233,234,235,236,237,238,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,241,241,241,241,241,241,241,241,241,241,241,241,241,241,241,241],[15,16,17,18,19,20,21,22,23,24,25,26,27,28,30,31,32,33,34,35,36,37,38,39,40,41,42,43,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,61,62,63,64,65,66,67,68,69,70,71,72,73,75,76,77,78,79,80,81,82,83,84,85,86,87,88,90,91,92,93,94,95,96,97,98,99,100,101,102,103,105,106,107,108,109,110,111,112,113,114,115,116,117,118,120,121,122,123,124,125,126,127,128,129,130,131,132,133,135,136,137,138,139,140,141,142,143,144,145,146,147,148,150,151,152,153,154,155,156,157,158,159,160,161,162,163,165,166,167,168,169,170,171,172,173,174,175,176,177,178,180,181,182,183,184,185,186,187,188,189,190,191,192,193,195,196,197,198,199,200,201,202,203,204,205,206,207,208,210,211,212,213,214,215,216,217,218,219,220,221,222,223,225,226,227,228,229,230,231,232,233,234,235,236,237,238,0,1,2,3,4,5,6,7,8,9,10,11,12,13,16,17,18,19,20,21,22,23,24,25,26,27,28,29,31,32,33,34,35,36,37,38,39,40,41,42,43,44,46,47,48,49,50,51,52,53,54,55,56,57,58,59,61,62,63,64,65,66,67,68,69,70,71,72,73,74,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,92,93,94,95,96,97,98,99,100,101,102,103,104,106,107,108,109,110,111,112,113,114,115,116,117,118,119,121,122,123,124,125,126,127,128,129,130,131,132,133,134,136,137,138,139,140,141,142,143,144,145,146,147,148,149,151,152,153,154,155,156,157,158,159,160,161,162,163,164,166,167,168,169,170,171,172,173,174,175,176,177,178,179,181,182,183,184,185,186,187,188,189,190,191,192,193,194,196,197,198,199,200,201,202,203,204,205,206,207,208,209,211,212,213,214,215,216,217,218,219,220,221,222,223,224,226,227,228,229,230,231,232,233,234,235,236,237,238,239,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,30,45,60,75,90,105,120,135,150,165,180,195,210,225,0,14,29,44,59,74,89,104,119,134,149,164,179,194,209,224,239],[16,17,18,19,20,21,22,23,24,25,26,27,28,29,31,32,33,34,35,36,37,38,39,40,41,42,43,44,46,47,48,49,50,51,52,53,54,55,56,57,58,59,61,62,63,64,65,66,67,68,69,70,71,72,73,74,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,92,93,94,95,96,97,98,99,100,101,102,103,104,106,107,108,109,110,111,112,113,114,115,116,117,118,119,121,122,123,124,125,126,127,128,129,130,131,132,133,134,136,137,138,139,140,141,142,143,144,145,146,147,148,149,151,152,153,154,155,156,157,158,159,160,161,162,163,164,166,167,168,169,170,171,172,173,174,175,176,177,178,179,181,182,183,184,185,186,187,188,189,190,191,192,193,194,196,197,198,199,200,201,202,203,204,205,206,207,208,209,211,212,213,214,215,216,217,218,219,220,221,222,223,224,226,227,228,229,230,231,232,233,234,235,236,237,238,239,1,2,3,4,5,6,7,8,9,10,11,12,13,14,1,2,3,4,5,6,7,8,9,10,11,12,13,14,16,17,18,19,20,21,22,23,24,25,26,27,28,29,31,32,33,34,35,36,37,38,39,40,41,42,43,44,46,47,48,49,50,51,52,53,54,55,56,57,58,59,61,62,63,64,65,66,67,68,69,70,71,72,73,74,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,92,93,94,95,96,97,98,99,100,101,102,103,104,106,107,108,109,110,111,112,113,114,115,116,117,118,119,121,122,123,124,125,126,127,128,129,130,131,132,133,134,136,137,138,139,140,141,142,143,144,145,146,147,148,149,151,152,153,154,155,156,157,158,159,160,161,162,163,164,166,167,168,169,170,171,172,173,174,175,176,177,178,179,181,182,183,184,185,186,187,188,189,190,191,192,193,194,196,197,198,199,200,201,202,203,204,205,206,207,208,209,211,212,213,214,215,216,217,218,219,220,221,222,223,224,226,227,228,229,230,231,232,233,234,235,236,237,238,239,0,15,30,45,60,75,90,105,120,135,150,165,180,195,210,225,29,44,59,74,89,104,119,134,149,164,179,194,209,224,239,14]],"material":[],"normals":null,"texcoords":[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0,0],[0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,0,1]],"meshColor":"vertices"},"context":{"shiny":false,"rmarkdown":"xaringan::moon_reader"},"players":[],"webGLoptions":{"preserveDrawingBuffer":true}},"evals":[],"jsHooks":[]}</script>
]

.pull-right[
* Our aim it to rotate the cloud to have the best viewpoint on the data.
* How can you charachterize this viewpoint?
* Look at scales!
]
---
This representation does not use the same scaling for variables due to the differences in ranges:


```r
summary(tab)
```

The same representation with iso-scaling:

```r
lims &lt;- 1.1 * c(min(tab), max(tab))
plot3d(tab, type = "s", col = color, xlim = lims, ylim = lims, 
    zlim = lims)
```

* What is the problem?

* How to solve it?
---
Data are in different units. Main variations are mainly driven by differences in variances. Standardization is required.

Center the data and see which geometric operation is induced:


```r
## centring
tab.c &lt;- scale(tab, center = TRUE, scale = FALSE)
myplot3d(tab.c, colpoints = color, colaxes = "black")
summary(tab.c)
```

Scale the data and see which geometric operation is induced:

```r
## scaling
tab.sc &lt;- scale(tab, center = TRUE, scale = TRUE)
myplot3d(tab.sc, colpoints = color, colaxes = "black")
```

Rotate and find the best viewpoint.
---
# Principal component analysis

Draw the principal axes


```r
pca &lt;- dudi.pca(tab, nf = 3, scannf = FALSE)
addvar3d(t(pca$c1), col = "red")
```

and project the sites on the principal axes


```r
## first PCA axis
for (i in 1:nrow(pca$tab)) segments3d(rbind(pca$c1[, 
    1] * pca$li[i, 1], tab.sc[i, ]), col = color[i], 
    lty = 3)

## second PCA axis
for (i in 1:nrow(pca$tab)) segments3d(rbind(pca$c1[, 
    2] * pca$li[i, 2], tab.sc[i, ]), col = color[i])
```
---
Lastly, we can use the principal axes as a new system of coordinates and represent the data in this new system


```r
open3d()
myplot3d(pca$li, colpoints = color, colaxes = "black")
addvar3d((pca$c1), col = "red")
```
---
# Space of variables

The same approach can be used to search for the best representation of variables. 


```r
tab2 &lt;- doubs$env[c(1, 11, 27), ]
tab2.sc &lt;- t(scale(doubs$env[c(1, 11, 27), ]))
color.var &lt;- rainbow(11)
myplot3d2(tab2.sc, colarrows = color.var, colaxes = "black")

## add PCA axes
pca2 &lt;- dudi.pca(tab2, nf = 3, scannf = FALSE)
addvar3d(t(pca2$l1), col = "red")
```

.center[
[Go back to course 1](../../course/session1/session1.html#12)

]
---
# PCA by hand

Use matrix algebra and the functions `cor`, `%*%` and `eigen` to recompute the outputs of PCA by hand



**Bonus**: Perform the singular value decomposition (function `svd`) of the standardized table (`scalewt(tab)`) and compare to the outputs of PCA


.center[
[Go back to course 1](../../course/session1/session1.html#18)

]
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
